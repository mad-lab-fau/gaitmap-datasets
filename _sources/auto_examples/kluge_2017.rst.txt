
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/kluge_2017.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_kluge_2017.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_kluge_2017.py:


Kluge2017 - A dataset for in-lab parameter validation in healthy and PD.
========================================================================

The Kluge 2017 dataset was recorded to test the validity of spatial-temporal parameters extracted from IMUs and their
test-retest reliability.
The dataset contains data from healthy participants and participants with Parkinson's disease.

General information
-------------------
Each participant performed 4x10m walk trials at a slow, preferred and fast speed.
Five of the participants performed the trials twice with two weeks in between.

The dataset contains IMU data from each foot recorded with the eGait system (sensor lateral attached to the shoe) and
reference data using a marker-less Simi Motion system.
Gait events were annotated manually based on the camera recordings und multiple points at the foot were tracked using
the Simi Motion system.

For each 10m walk, only the middle 3 m are covered by the Simi Motion system, resulting on avaerage in 2-4 strides per
walk-through.

The eGait system in the dataset used the Shimmer 3 sensors using a sampling rate of 102.4 Hz.
For the data loaded using the dataset class, we adjust the coordinate system as shown in the figure below.
While the sensor configuration is identical to other Shimmer 3 datasets, the coordiante system of the exported data
was already rotated to align both feets.
Hence, we need to perform a different coordinate transformation than for the other datasets:

.. figure:: /images/coordinate_systems/coordinate_transform_kluge_2017.svg
    :alt: coordinate system definition
    :figclass: align-center

.. GENERATED FROM PYTHON SOURCE LINES 34-36

.. warning:: For this example to work, you need to have a global config set containing the path to the dataset.
             Check the `README.md` for more information.

.. GENERATED FROM PYTHON SOURCE LINES 36-39

.. code-block:: default


    from gaitmap_datasets import Kluge2017








.. GENERATED FROM PYTHON SOURCE LINES 40-43

First we will create a simple instance of the dataset class.
We can see that for each participant we have 3 different walking speeds, the information if they are healthy or PD
(patient = `True`) and if the data was recorded in the first or second session.

.. GENERATED FROM PYTHON SOURCE LINES 43-46

.. code-block:: default

    dataset = Kluge2017()
    dataset






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <h4 style="margin-bottom: 0.1em;">Kluge2017 [75 groups/rows]</h3>
    <div style="margin-top: 0em">
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table style="margin-left: 3em;">
      <thead>
        <tr style="text-align: right;">
          <th style="text-align: center;"></th>
          <th style="text-align: center;">patient</th>
          <th style="text-align: center;">participant</th>
          <th style="text-align: center;">repetition</th>
          <th style="text-align: center;">speed</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th style="text-align: center;">0</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">False</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">216060</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">fast</td>
        </tr>
        <tr>
          <th style="text-align: center;">1</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">False</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">216060</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">normal</td>
        </tr>
        <tr>
          <th style="text-align: center;">2</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">False</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">216060</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">slow</td>
        </tr>
        <tr>
          <th style="text-align: center;">3</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">False</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">216061</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">1</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">fast</td>
        </tr>
        <tr>
          <th style="text-align: center;">4</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">False</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">216061</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">1</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">normal</td>
        </tr>
        <tr>
          <th style="text-align: center;">...</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">...</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">...</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">...</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">...</td>
        </tr>
        <tr>
          <th style="text-align: center;">70</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">215001</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">normal</td>
        </tr>
        <tr>
          <th style="text-align: center;">71</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">215001</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">slow</td>
        </tr>
        <tr>
          <th style="text-align: center;">72</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">413050</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">fast</td>
        </tr>
        <tr>
          <th style="text-align: center;">73</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">413050</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">normal</td>
        </tr>
        <tr>
          <th style="text-align: center;">74</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">413050</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">slow</td>
        </tr>
      </tbody>
    </table>
    <p>75 rows Ã— 4 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 47-48

Based on the index, we will select just the PD cohort

.. GENERATED FROM PYTHON SOURCE LINES 48-51

.. code-block:: default

    pd_cohort = dataset.get_subset(patient=True)
    pd_cohort






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <h4 style="margin-bottom: 0.1em;">Kluge2017 [12 groups/rows]</h3>
    <div style="margin-top: 0em">
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table style="margin-left: 3em;">
      <thead>
        <tr style="text-align: right;">
          <th style="text-align: center;"></th>
          <th style="text-align: center;">patient</th>
          <th style="text-align: center;">participant</th>
          <th style="text-align: center;">repetition</th>
          <th style="text-align: center;">speed</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th style="text-align: center;">0</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">115053</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">fast</td>
        </tr>
        <tr>
          <th style="text-align: center;">1</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">115053</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">normal</td>
        </tr>
        <tr>
          <th style="text-align: center;">2</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">115053</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">slow</td>
        </tr>
        <tr>
          <th style="text-align: center;">3</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">214019</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">fast</td>
        </tr>
        <tr>
          <th style="text-align: center;">4</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">214019</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">normal</td>
        </tr>
        <tr>
          <th style="text-align: center;">5</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">214019</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">slow</td>
        </tr>
        <tr>
          <th style="text-align: center;">6</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">215001</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">fast</td>
        </tr>
        <tr>
          <th style="text-align: center;">7</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">215001</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">normal</td>
        </tr>
        <tr>
          <th style="text-align: center;">8</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">215001</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">slow</td>
        </tr>
        <tr>
          <th style="text-align: center;">9</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">413050</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">fast</td>
        </tr>
        <tr>
          <th style="text-align: center;">10</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">413050</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">normal</td>
        </tr>
        <tr>
          <th style="text-align: center;">11</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">413050</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">slow</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 52-53

We will simply select the first participant in the dataset for the following analysis

.. GENERATED FROM PYTHON SOURCE LINES 53-56

.. code-block:: default

    participant = pd_cohort.groupby("participant")[0].groupby(None)
    participant






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <h4 style="margin-bottom: 0.1em;">Kluge2017 [3 groups/rows]</h3>
    <div style="margin-top: 0em">
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table style="margin-left: 3em;">
      <thead>
        <tr style="text-align: right;">
          <th style="text-align: center;"></th>
          <th style="text-align: center;">patient</th>
          <th style="text-align: center;">participant</th>
          <th style="text-align: center;">repetition</th>
          <th style="text-align: center;">speed</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th style="text-align: center;">0</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">115053</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">fast</td>
        </tr>
        <tr>
          <th style="text-align: center;">1</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">115053</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">normal</td>
        </tr>
        <tr>
          <th style="text-align: center;">2</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">115053</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">slow</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 57-58

Let's have a look at the slow walk data

.. GENERATED FROM PYTHON SOURCE LINES 58-61

.. code-block:: default

    slow_walk = participant.get_subset(speed="slow")
    slow_walk






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <h4 style="margin-bottom: 0.1em;">Kluge2017 [1 groups/rows]</h3>
    <div style="margin-top: 0em">
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table style="margin-left: 3em;">
      <thead>
        <tr style="text-align: right;">
          <th style="text-align: center;"></th>
          <th style="text-align: center;">patient</th>
          <th style="text-align: center;">participant</th>
          <th style="text-align: center;">repetition</th>
          <th style="text-align: center;">speed</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th style="text-align: center;">0</th>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">True</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">115053</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">0</td>
          <td style="text-align: center; padding-left: 2em; padding-right: 2em;">slow</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 62-66

For each gait test, we have access to the raw IMU data, the marker position data and the gait events.
Let's have a look at the raw IMU data.
This is a dictionary with the sensor name as key and a pandas DataFrame as value.
Note that the index is the time in seconds already aligned with the mocap data.

.. GENERATED FROM PYTHON SOURCE LINES 66-71

.. code-block:: default

    foot = "right"

    imu_data = slow_walk.data[f"{foot}_sensor"]
    imu_data






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>acc_x</th>
          <th>acc_y</th>
          <th>acc_z</th>
          <th>gyr_x</th>
          <th>gyr_y</th>
          <th>gyr_z</th>
        </tr>
        <tr>
          <th>time after start [s]</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0.007812</th>
          <td>-0.606944</td>
          <td>-0.806221</td>
          <td>9.749680</td>
          <td>-0.233754</td>
          <td>-2.983602</td>
          <td>1.094100</td>
        </tr>
        <tr>
          <th>0.017578</th>
          <td>-0.529068</td>
          <td>-0.844837</td>
          <td>9.633973</td>
          <td>0.691206</td>
          <td>-3.561525</td>
          <td>0.420545</td>
        </tr>
        <tr>
          <th>0.027344</th>
          <td>-0.490796</td>
          <td>-0.768402</td>
          <td>9.555994</td>
          <td>0.989510</td>
          <td>-4.397582</td>
          <td>0.238766</td>
        </tr>
        <tr>
          <th>0.037109</th>
          <td>-0.452116</td>
          <td>-0.768090</td>
          <td>9.556089</td>
          <td>2.782382</td>
          <td>-4.679503</td>
          <td>0.113708</td>
        </tr>
        <tr>
          <th>0.046875</th>
          <td>-0.490779</td>
          <td>-0.843053</td>
          <td>9.827733</td>
          <td>4.531894</td>
          <td>-4.103905</td>
          <td>-0.197483</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>65.544922</th>
          <td>-0.721370</td>
          <td>-1.037000</td>
          <td>9.789950</td>
          <td>0.419637</td>
          <td>11.173907</td>
          <td>3.775545</td>
        </tr>
        <tr>
          <th>65.554688</th>
          <td>-0.837001</td>
          <td>-1.114059</td>
          <td>9.867739</td>
          <td>3.130379</td>
          <td>12.023181</td>
          <td>4.900520</td>
        </tr>
        <tr>
          <th>65.564453</th>
          <td>-0.953323</td>
          <td>-1.076638</td>
          <td>9.867153</td>
          <td>3.852850</td>
          <td>12.442962</td>
          <td>5.295863</td>
        </tr>
        <tr>
          <th>65.574219</th>
          <td>-0.952116</td>
          <td>-1.230358</td>
          <td>9.829633</td>
          <td>4.541235</td>
          <td>12.803124</td>
          <td>5.783288</td>
        </tr>
        <tr>
          <th>65.583984</th>
          <td>-0.991486</td>
          <td>-1.116189</td>
          <td>9.751162</td>
          <td>5.986108</td>
          <td>12.502267</td>
          <td>6.087537</td>
        </tr>
      </tbody>
    </table>
    <p>6716 rows Ã— 6 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 72-80

Then let's also load the marker position data.
As all markers trajectories have the same length, this is just a simple pandas DataFrame, with the foot as the
top-most column level.
We can see that we get position, velocity and acceleration data for the ankle and the tip of the foot.
Note that these trajectories are from "actual" markers, but virtual markers defined by the biomechanical model fitted
by the SIMI system.

Many values in the dataframe will be NaN, as the mocap system only tracks the foot for a short period of time.

.. GENERATED FROM PYTHON SOURCE LINES 80-83

.. code-block:: default

    mocap_data = slow_walk.marker_position_[foot]
    mocap_data






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead tr th {
            text-align: left;
        }

        .dataframe thead tr:last-of-type th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr>
          <th>marker</th>
          <th colspan="9" halign="left">ankle</th>
          <th colspan="9" halign="left">foot_tip</th>
        </tr>
        <tr>
          <th>metric</th>
          <th>pos_x</th>
          <th>pos_y</th>
          <th>pos_z</th>
          <th>vel_x</th>
          <th>vel_y</th>
          <th>vel_z</th>
          <th>acc_x</th>
          <th>acc_y</th>
          <th>acc_z</th>
          <th>pos_x</th>
          <th>pos_y</th>
          <th>pos_z</th>
          <th>vel_x</th>
          <th>vel_y</th>
          <th>vel_z</th>
          <th>acc_x</th>
          <th>acc_y</th>
          <th>acc_z</th>
        </tr>
        <tr>
          <th>time after start [s]</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>1.000000e-06</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>9.995000e-03</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>1.999800e-02</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>3.000000e-02</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>3.999400e-02</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>6.555000e+01</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>6.555999e+01</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>6.557000e+01</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>6.557999e+01</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>6.558999e+01</th>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
          <td>NaN</td>
        </tr>
      </tbody>
    </table>
    <p>6560 rows Ã— 18 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 84-85

Let's plot the position of the foot marker and the IMU data together.

.. GENERATED FROM PYTHON SOURCE LINES 85-111

.. code-block:: default

    import matplotlib.pyplot as plt

    fig, (ax1, ax2, ax3, ax4, ax5) = plt.subplots(nrows=5, sharex=True, figsize=(10, 10))
    fig.suptitle(f"{slow_walk.group} - {foot} foot")
    # Plot the IMU data
    ax1.set_title("Gyro")
    ax1.set_ylabel("deg/s")
    imu_data.filter(like="gyr").plot(ax=ax1)
    ax2.set_title("Acc")
    ax2.set_ylabel("m/sÂ²")
    imu_data.filter(like="acc").plot(ax=ax2)

    # Plot the mocap data
    ax3.set_title("Marker position X")
    ax3.set_ylabel("m")
    mocap_data.xs("pos_x", level=1, axis=1).plot(ax=ax3)
    ax4.set_title("Marker position Y")
    ax4.set_ylabel("m")
    mocap_data.xs("pos_y", level=1, axis=1).plot(ax=ax4)
    ax5.set_title("Marker position Z")
    ax5.set_ylabel("m")
    mocap_data.xs("pos_z", level=1, axis=1).plot(ax=ax5)

    plt.tight_layout()
    plt.show()




.. image-sg:: /auto_examples/images/sphx_glr_kluge_2017_001.png
   :alt: Kluge2017(patient=True, participant='115053', repetition=0, speed='slow') - right foot, Gyro, Acc, Marker position X, Marker position Y, Marker position Z
   :srcset: /auto_examples/images/sphx_glr_kluge_2017_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 112-121

We can also plot the gait events on top of the data.
The gait events are stored in a dictionary with the foot as key and a pandas DataFrame as value.
Each row in the DataFrame represents one gait stride.
Each stride starts and ends with a heel strike/initial contact (IC) of the same foot.
The `HS` event provided with the stride is the start event.
In addition, we have the toe-off (TO), the heel-off (HO).
The terminal contact (TC) is either the TO or the HO depending on which event occurs last.

All events are provided as samples in the Mocap data.

.. GENERATED FROM PYTHON SOURCE LINES 121-125

.. code-block:: default


    gait_events = slow_walk.mocap_events_[foot]
    gait_events






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th>event</th>
          <th>ho</th>
          <th>ic</th>
          <th>to</th>
          <th>start</th>
          <th>end</th>
          <th>tc</th>
        </tr>
        <tr>
          <th>s_id</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>54</th>
          <td>508</td>
          <td>438</td>
          <td>527</td>
          <td>438</td>
          <td>576</td>
          <td>527</td>
        </tr>
        <tr>
          <th>56</th>
          <td>650</td>
          <td>576</td>
          <td>669</td>
          <td>576</td>
          <td>722</td>
          <td>669</td>
        </tr>
        <tr>
          <th>58</th>
          <td>788</td>
          <td>722</td>
          <td>811</td>
          <td>722</td>
          <td>854</td>
          <td>811</td>
        </tr>
        <tr>
          <th>67</th>
          <td>2121</td>
          <td>2047</td>
          <td>2146</td>
          <td>2047</td>
          <td>2196</td>
          <td>2146</td>
        </tr>
        <tr>
          <th>69</th>
          <td>2256</td>
          <td>2196</td>
          <td>2279</td>
          <td>2196</td>
          <td>2330</td>
          <td>2279</td>
        </tr>
        <tr>
          <th>71</th>
          <td>2402</td>
          <td>2330</td>
          <td>2418</td>
          <td>2330</td>
          <td>2467</td>
          <td>2418</td>
        </tr>
        <tr>
          <th>73</th>
          <td>2532</td>
          <td>2467</td>
          <td>2558</td>
          <td>2467</td>
          <td>2607</td>
          <td>2558</td>
        </tr>
        <tr>
          <th>84</th>
          <td>3813</td>
          <td>3749</td>
          <td>3841</td>
          <td>3749</td>
          <td>3892</td>
          <td>3841</td>
        </tr>
        <tr>
          <th>86</th>
          <td>3964</td>
          <td>3892</td>
          <td>3986</td>
          <td>3892</td>
          <td>4037</td>
          <td>3986</td>
        </tr>
        <tr>
          <th>88</th>
          <td>4105</td>
          <td>4037</td>
          <td>4129</td>
          <td>4037</td>
          <td>4182</td>
          <td>4129</td>
        </tr>
        <tr>
          <th>90</th>
          <td>4241</td>
          <td>4182</td>
          <td>4265</td>
          <td>4182</td>
          <td>4314</td>
          <td>4265</td>
        </tr>
        <tr>
          <th>97</th>
          <td>5618</td>
          <td>5553</td>
          <td>5644</td>
          <td>5553</td>
          <td>5681</td>
          <td>5644</td>
        </tr>
        <tr>
          <th>99</th>
          <td>5737</td>
          <td>5681</td>
          <td>5766</td>
          <td>5681</td>
          <td>5820</td>
          <td>5766</td>
        </tr>
        <tr>
          <th>101</th>
          <td>5884</td>
          <td>5820</td>
          <td>5910</td>
          <td>5820</td>
          <td>5961</td>
          <td>5910</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 126-127

Let's plot the gait events on top of the data.

.. GENERATED FROM PYTHON SOURCE LINES 127-177

.. code-block:: default


    import matplotlib.pyplot as plt


    def plot_with_marker():
        fig, (ax1, ax2, ax3) = plt.subplots(nrows=3, sharex=True, figsize=(10, 6))
        fig.suptitle(f"{slow_walk.group} - {foot} foot")

        # Plot the IMU data
        ax1.set_title("Gyro")
        ax1.set_ylabel("deg/s")
        imu_data.filter(like="gyr").plot(ax=ax1)
        ax2.set_title("Acc")
        ax2.set_ylabel("m/sÂ²")
        imu_data.filter(like="acc").plot(ax=ax2)

        # Plot the mocap data
        ax3.set_title("Marker position ankle Z")
        ax3.set_ylabel("m")
        mocap_data[("ankle", "pos_z")].plot(ax=ax3)

        # Plot the gait events
        for i, (_, stride_mocap) in enumerate(gait_events.iterrows()):
            stride_time = stride_mocap / slow_walk.mocap_sampling_rate_hz_
            stride_imu = (stride_time * slow_walk.sampling_rate_hz).round().astype(int)

            for ax, plot_data in zip(
                (ax1, ax2, ax3), (imu_data["gyr_y"], imu_data["acc_x"], mocap_data[("ankle", "pos_z")])
            ):
                # Plot the stride as a vertical span
                ax.axvspan(stride_time.start, stride_time.end, alpha=0.2, edgecolor="black")

                index_values = stride_imu
                if ax == ax3:
                    index_values = stride_mocap

                # Plot the individual events
                ax.plot(stride_time.to, plot_data.iloc[index_values.to], "s", color="blue", label="to" if i == 0 else None)
                ax.plot(stride_time.ho, plot_data.iloc[index_values.ho], "o", color="red", label="ho" if i == 0 else None)
                ax.plot(stride_time.tc, plot_data.iloc[index_values.tc], "x", color="green", label="tc" if i == 0 else None)

        ax3.legend()

        return fig, (ax1, ax2, ax3)


    plot_with_marker()
    plt.tight_layout()
    plt.show()




.. image-sg:: /auto_examples/images/sphx_glr_kluge_2017_002.png
   :alt: Kluge2017(patient=True, participant='115053', repetition=0, speed='slow') - right foot, Gyro, Acc, Marker position ankle Z
   :srcset: /auto_examples/images/sphx_glr_kluge_2017_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 178-179

To better see what is going on, we will zoom into one WB.

.. GENERATED FROM PYTHON SOURCE LINES 179-183

.. code-block:: default

    _, (_, _, ax3) = plot_with_marker()
    ax3.set_xlim(53, 61)
    plt.show()




.. image-sg:: /auto_examples/images/sphx_glr_kluge_2017_003.png
   :alt: Kluge2017(patient=True, participant='115053', repetition=0, speed='slow') - right foot, Gyro, Acc, Marker position ankle Z
   :srcset: /auto_examples/images/sphx_glr_kluge_2017_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 184-189

We can see that all the gait events occur in order and roughly line up with the expected signal regions in the IMU
signal.
We can also see that the z-axis of the ankle marker is drifting over the course of each walk.
This is because the mocap system is not calibrated level to the floor.
In case parameters like foot-clearance are calculated, this needs to be taken into account.

.. GENERATED FROM PYTHON SOURCE LINES 191-196

Spatial Parameters
------------------
In case you want to caluclate spatial parameters based on the trajectories and events, you can use the
`marker_position_per_stride_` property.
It provides the marker information per stride, making it easy to calculate various parameters

.. GENERATED FROM PYTHON SOURCE LINES 196-199

.. code-block:: default

    per_stride = slow_walk.marker_position_per_stride_[foot]
    per_stride






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead tr th {
            text-align: left;
        }

        .dataframe thead tr:last-of-type th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr>
          <th></th>
          <th>marker</th>
          <th colspan="9" halign="left">ankle</th>
          <th colspan="9" halign="left">foot_tip</th>
        </tr>
        <tr>
          <th></th>
          <th>metric</th>
          <th>pos_x</th>
          <th>pos_y</th>
          <th>pos_z</th>
          <th>vel_x</th>
          <th>vel_y</th>
          <th>vel_z</th>
          <th>acc_x</th>
          <th>acc_y</th>
          <th>acc_z</th>
          <th>pos_x</th>
          <th>pos_y</th>
          <th>pos_z</th>
          <th>vel_x</th>
          <th>vel_y</th>
          <th>vel_z</th>
          <th>acc_x</th>
          <th>acc_y</th>
          <th>acc_z</th>
        </tr>
        <tr>
          <th>s_id</th>
          <th>sample</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th rowspan="5" valign="top">54</th>
          <th>0</th>
          <td>0.192753</td>
          <td>1.958257</td>
          <td>0.082491</td>
          <td>0.286104</td>
          <td>-0.200563</td>
          <td>-0.097244</td>
          <td>0.721611</td>
          <td>8.414624</td>
          <td>0.803715</td>
          <td>0.200133</td>
          <td>1.704741</td>
          <td>0.176551</td>
          <td>0.080548</td>
          <td>-0.418227</td>
          <td>-0.721726</td>
          <td>-13.600050</td>
          <td>5.803189</td>
          <td>-11.501573</td>
        </tr>
        <tr>
          <th>1</th>
          <td>0.193070</td>
          <td>1.950421</td>
          <td>0.071967</td>
          <td>0.261980</td>
          <td>-0.049779</td>
          <td>-0.071751</td>
          <td>0.374040</td>
          <td>9.592503</td>
          <td>8.698684</td>
          <td>0.201110</td>
          <td>1.698432</td>
          <td>0.169994</td>
          <td>-0.039450</td>
          <td>-0.267904</td>
          <td>-0.710838</td>
          <td>-12.476939</td>
          <td>7.288913</td>
          <td>-3.356514</td>
        </tr>
        <tr>
          <th>2</th>
          <td>0.199773</td>
          <td>1.955140</td>
          <td>0.077238</td>
          <td>0.248103</td>
          <td>-0.058738</td>
          <td>-0.091036</td>
          <td>-4.638317</td>
          <td>8.426217</td>
          <td>8.246024</td>
          <td>0.193884</td>
          <td>1.695691</td>
          <td>0.153551</td>
          <td>-0.339818</td>
          <td>-0.270176</td>
          <td>-0.831751</td>
          <td>-5.776758</td>
          <td>8.854914</td>
          <td>4.857469</td>
        </tr>
        <tr>
          <th>3</th>
          <td>0.203452</td>
          <td>1.954273</td>
          <td>0.079510</td>
          <td>0.274201</td>
          <td>-0.068357</td>
          <td>0.102675</td>
          <td>-6.699009</td>
          <td>-0.698306</td>
          <td>3.084113</td>
          <td>0.190630</td>
          <td>1.694360</td>
          <td>0.153355</td>
          <td>-0.479444</td>
          <td>-0.299115</td>
          <td>-0.793489</td>
          <td>-2.950642</td>
          <td>1.387353</td>
          <td>4.389224</td>
        </tr>
        <tr>
          <th>4</th>
          <td>0.203464</td>
          <td>1.954910</td>
          <td>0.077449</td>
          <td>0.112368</td>
          <td>0.150302</td>
          <td>0.275149</td>
          <td>-6.473012</td>
          <td>-5.153564</td>
          <td>1.867230</td>
          <td>0.189794</td>
          <td>1.693608</td>
          <td>0.146054</td>
          <td>-0.278234</td>
          <td>-0.048348</td>
          <td>-0.523989</td>
          <td>1.823821</td>
          <td>-3.238908</td>
          <td>3.602642</td>
        </tr>
        <tr>
          <th>...</th>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th rowspan="5" valign="top">101</th>
          <th>137</th>
          <td>0.349034</td>
          <td>2.297499</td>
          <td>0.056475</td>
          <td>-0.493256</td>
          <td>0.644704</td>
          <td>-0.112424</td>
          <td>1.574143</td>
          <td>-5.545146</td>
          <td>-4.041856</td>
          <td>0.410542</td>
          <td>2.556118</td>
          <td>0.106533</td>
          <td>0.308624</td>
          <td>0.591946</td>
          <td>-0.671209</td>
          <td>-8.179141</td>
          <td>-3.797458</td>
          <td>-10.331998</td>
        </tr>
        <tr>
          <th>138</th>
          <td>0.349848</td>
          <td>2.298396</td>
          <td>0.057959</td>
          <td>-0.397720</td>
          <td>0.497977</td>
          <td>-0.291812</td>
          <td>-1.411988</td>
          <td>-3.820587</td>
          <td>-4.530557</td>
          <td>0.417965</td>
          <td>2.557068</td>
          <td>0.098224</td>
          <td>0.125974</td>
          <td>0.469589</td>
          <td>-0.713592</td>
          <td>-3.917129</td>
          <td>-3.669168</td>
          <td>-10.004805</td>
        </tr>
        <tr>
          <th>139</th>
          <td>0.344574</td>
          <td>2.310484</td>
          <td>0.058835</td>
          <td>-0.205808</td>
          <td>0.457452</td>
          <td>-0.254028</td>
          <td>5.376377</td>
          <td>-6.819976</td>
          <td>-5.684798</td>
          <td>0.410538</td>
          <td>2.570010</td>
          <td>0.097141</td>
          <td>-0.075496</td>
          <td>0.476007</td>
          <td>-0.643591</td>
          <td>-7.225660</td>
          <td>-5.294753</td>
          <td>-3.979611</td>
        </tr>
        <tr>
          <th>140</th>
          <td>0.339505</td>
          <td>2.324432</td>
          <td>0.051485</td>
          <td>-0.363760</td>
          <td>0.522266</td>
          <td>-0.151031</td>
          <td>10.019334</td>
          <td>-7.228755</td>
          <td>1.519903</td>
          <td>0.418452</td>
          <td>2.579842</td>
          <td>0.092782</td>
          <td>0.004334</td>
          <td>0.487045</td>
          <td>-0.719070</td>
          <td>-11.001638</td>
          <td>-3.606945</td>
          <td>3.266294</td>
        </tr>
        <tr>
          <th>141</th>
          <td>0.340955</td>
          <td>2.317538</td>
          <td>0.045446</td>
          <td>-0.296046</td>
          <td>0.402155</td>
          <td>-0.327242</td>
          <td>5.374675</td>
          <td>-6.203757</td>
          <td>8.011034</td>
          <td>0.408858</td>
          <td>2.577185</td>
          <td>0.079282</td>
          <td>-0.026589</td>
          <td>0.370898</td>
          <td>-0.776057</td>
          <td>-5.104494</td>
          <td>-4.194661</td>
          <td>4.593462</td>
        </tr>
      </tbody>
    </table>
    <p>1963 rows Ã— 18 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 200-201

To extract the information of a single stride (e.g. stride_ist 55), we can use the `loc` method.

.. GENERATED FROM PYTHON SOURCE LINES 201-204

.. code-block:: default

    stride_54 = per_stride.loc[54]
    stride_54






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead tr th {
            text-align: left;
        }

        .dataframe thead tr:last-of-type th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr>
          <th>marker</th>
          <th colspan="9" halign="left">ankle</th>
          <th colspan="9" halign="left">foot_tip</th>
        </tr>
        <tr>
          <th>metric</th>
          <th>pos_x</th>
          <th>pos_y</th>
          <th>pos_z</th>
          <th>vel_x</th>
          <th>vel_y</th>
          <th>vel_z</th>
          <th>acc_x</th>
          <th>acc_y</th>
          <th>acc_z</th>
          <th>pos_x</th>
          <th>pos_y</th>
          <th>pos_z</th>
          <th>vel_x</th>
          <th>vel_y</th>
          <th>vel_z</th>
          <th>acc_x</th>
          <th>acc_y</th>
          <th>acc_z</th>
        </tr>
        <tr>
          <th>sample</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>0.192753</td>
          <td>1.958257</td>
          <td>0.082491</td>
          <td>0.286104</td>
          <td>-0.200563</td>
          <td>-0.097244</td>
          <td>0.721611</td>
          <td>8.414624</td>
          <td>0.803715</td>
          <td>0.200133</td>
          <td>1.704741</td>
          <td>0.176551</td>
          <td>0.080548</td>
          <td>-0.418227</td>
          <td>-0.721726</td>
          <td>-13.600050</td>
          <td>5.803189</td>
          <td>-11.501573</td>
        </tr>
        <tr>
          <th>1</th>
          <td>0.193070</td>
          <td>1.950421</td>
          <td>0.071967</td>
          <td>0.261980</td>
          <td>-0.049779</td>
          <td>-0.071751</td>
          <td>0.374040</td>
          <td>9.592503</td>
          <td>8.698684</td>
          <td>0.201110</td>
          <td>1.698432</td>
          <td>0.169994</td>
          <td>-0.039450</td>
          <td>-0.267904</td>
          <td>-0.710838</td>
          <td>-12.476939</td>
          <td>7.288913</td>
          <td>-3.356514</td>
        </tr>
        <tr>
          <th>2</th>
          <td>0.199773</td>
          <td>1.955140</td>
          <td>0.077238</td>
          <td>0.248103</td>
          <td>-0.058738</td>
          <td>-0.091036</td>
          <td>-4.638317</td>
          <td>8.426217</td>
          <td>8.246024</td>
          <td>0.193884</td>
          <td>1.695691</td>
          <td>0.153551</td>
          <td>-0.339818</td>
          <td>-0.270176</td>
          <td>-0.831751</td>
          <td>-5.776758</td>
          <td>8.854914</td>
          <td>4.857469</td>
        </tr>
        <tr>
          <th>3</th>
          <td>0.203452</td>
          <td>1.954273</td>
          <td>0.079510</td>
          <td>0.274201</td>
          <td>-0.068357</td>
          <td>0.102675</td>
          <td>-6.699009</td>
          <td>-0.698306</td>
          <td>3.084113</td>
          <td>0.190630</td>
          <td>1.694360</td>
          <td>0.153355</td>
          <td>-0.479444</td>
          <td>-0.299115</td>
          <td>-0.793489</td>
          <td>-2.950642</td>
          <td>1.387353</td>
          <td>4.389224</td>
        </tr>
        <tr>
          <th>4</th>
          <td>0.203464</td>
          <td>1.954910</td>
          <td>0.077449</td>
          <td>0.112368</td>
          <td>0.150302</td>
          <td>0.275149</td>
          <td>-6.473012</td>
          <td>-5.153564</td>
          <td>1.867230</td>
          <td>0.189794</td>
          <td>1.693608</td>
          <td>0.146054</td>
          <td>-0.278234</td>
          <td>-0.048348</td>
          <td>-0.523989</td>
          <td>1.823821</td>
          <td>-3.238908</td>
          <td>3.602642</td>
        </tr>
        <tr>
          <th>...</th>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
          <td>...</td>
        </tr>
        <tr>
          <th>134</th>
          <td>0.241468</td>
          <td>0.760751</td>
          <td>0.111336</td>
          <td>0.218162</td>
          <td>-0.831061</td>
          <td>-0.031026</td>
          <td>2.153917</td>
          <td>12.167150</td>
          <td>-7.792384</td>
          <td>0.228153</td>
          <td>0.509273</td>
          <td>0.210098</td>
          <td>-0.539473</td>
          <td>-0.926413</td>
          <td>-0.252263</td>
          <td>0.766407</td>
          <td>8.995751</td>
          <td>-18.505880</td>
        </tr>
        <tr>
          <th>135</th>
          <td>0.244614</td>
          <td>0.751074</td>
          <td>0.111428</td>
          <td>0.156707</td>
          <td>-0.754187</td>
          <td>-0.101599</td>
          <td>0.823188</td>
          <td>17.730366</td>
          <td>-7.090275</td>
          <td>0.218403</td>
          <td>0.501140</td>
          <td>0.211520</td>
          <td>-0.561376</td>
          <td>-0.832486</td>
          <td>-0.322680</td>
          <td>7.949738</td>
          <td>13.164203</td>
          <td>-22.556181</td>
        </tr>
        <tr>
          <th>136</th>
          <td>0.243416</td>
          <td>0.744900</td>
          <td>0.107063</td>
          <td>0.244162</td>
          <td>-0.764780</td>
          <td>-0.175111</td>
          <td>0.471186</td>
          <td>14.072620</td>
          <td>-4.902506</td>
          <td>0.232609</td>
          <td>0.492156</td>
          <td>0.202855</td>
          <td>-0.305319</td>
          <td>-0.796774</td>
          <td>-0.360671</td>
          <td>4.651704</td>
          <td>12.463881</td>
          <td>-15.043660</td>
        </tr>
        <tr>
          <th>137</th>
          <td>0.244126</td>
          <td>0.741234</td>
          <td>0.109109</td>
          <td>0.306830</td>
          <td>-0.430380</td>
          <td>-0.218322</td>
          <td>4.352034</td>
          <td>8.988792</td>
          <td>-4.125971</td>
          <td>0.221726</td>
          <td>0.487249</td>
          <td>0.199454</td>
          <td>-0.072033</td>
          <td>-0.549494</td>
          <td>-0.702970</td>
          <td>2.152110</td>
          <td>10.498327</td>
          <td>-9.447768</td>
        </tr>
        <tr>
          <th>138</th>
          <td>0.243791</td>
          <td>0.727777</td>
          <td>0.106066</td>
          <td>0.235850</td>
          <td>-0.244594</td>
          <td>-0.201803</td>
          <td>4.433455</td>
          <td>11.586198</td>
          <td>-1.939656</td>
          <td>0.223650</td>
          <td>0.473770</td>
          <td>0.196879</td>
          <td>-0.239267</td>
          <td>-0.394179</td>
          <td>-0.823661</td>
          <td>-2.620951</td>
          <td>12.868330</td>
          <td>-10.005720</td>
        </tr>
      </tbody>
    </table>
    <p>139 rows Ã— 18 columns</p>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 205-210

.. code-block:: default

    fig, ax = plt.subplots()
    stride_54["ankle"].filter(like="pos_").plot(ax=ax)

    fig.show()




.. image-sg:: /auto_examples/images/sphx_glr_kluge_2017_004.png
   :alt: kluge 2017
   :srcset: /auto_examples/images/sphx_glr_kluge_2017_004.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 211-223

Further Notes
-------------
1. When applying a train test split on the data, remember that some participants have multiple recordings.
   Hence, always group by participant before splitting (see tpcp documentation for more details).
2. When comparing the results of an IMU algorithm to the mocap data, the recommended way is to compare based on
   aggregated values over the entire gait test, as alignment of individual strides might not always be possible and
   hide issues, when an algorithm is missing multiple strides.
   However, keep in mind that the mocap system only covers the middle part of each walk.
   This means that when comparing aggregated values (in particular measures of variance) using all detected strides in
   the IMU signal might result in a biased comparison.
3. When calculating spatial parameters, we recommend the use of the ankle trajectory, as it is the most stable
   trajectory.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  24.243 seconds)

**Estimated memory usage:**  682 MB


.. _sphx_glr_download_auto_examples_kluge_2017.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: kluge_2017.py <kluge_2017.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: kluge_2017.ipynb <kluge_2017.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
